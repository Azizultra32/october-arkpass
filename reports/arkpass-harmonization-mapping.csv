"Feature/Function","Supabase Entities","Key ArkPass Columns / Functions","FHIR Resources","FHIR Notes / Extensions","Armada Logic Assets","Reference Docs"
"Medications","medications; medication_conditions; medication_documents; medication_vocabularies","name, dosage, frequency, status, start_date_raw → display columns, created_via for quick add","MedicationStatement (primary); MedicationRequest (prescriptions)","reasonCode for indication; reasonReference to linked conditions; derivedFrom for document links","Medication.MultiCondition.Display (logic/rules/display/medication-multi-condition.all)","openspec/specs/medications/spec.md; MEDICATIONS_SCREENS_SPECS.md; FHIR_HARMONIZATION_MAP.md#1.1"
"Allergies","allergies; allergy_documents; allergy_vocabularies","allergen, category, severity, reaction, requires_epipen, onset_raw JSONB","AllergyIntolerance","Custom extension for requires_epipen; category maps 5 ArkPass classes → FHIR category; onset uses dual-mode date","Pending (no Armada rule yet)","openspec/specs/allergies/spec.md; ALLERGIES_SCREENS_SPECS.md; FHIR_HARMONIZATION_MAP.md#1.2"
"Conditions","conditions; condition_documents; medication_conditions; condition_vocabularies","name, clinical_status, tags[], start_date_raw, end_date_raw, severity","Condition","tags[] → category coding; diagnosis vs symptom onset handled via dual-date fields; supportingInfo for documents","Medication.MultiCondition.Display (shared context)","openspec/specs/conditions/spec.md; CONDITIONS_SCREENS_SPECS.md; FHIR_HARMONIZATION_MAP.md#1.3"
"Surgeries","surgeries; surgery_documents","name, date_raw, facility, surgeon, complications","Procedure","supportingInfo for documents; outcome/status stored in notes; facility maps to performer/location","Pending","openspec/specs/surgeries/spec.md; SURGERIES_SCREENS_SPECS.md; FHIR_HARMONIZATION_MAP.md#1.5"
"Immunizations","immunizations; immunization_doses; immunization_documents","name, occurrence_raw, lot_number, dose_number, complications","Immunization","protocolApplied.doseNumberInteger for doses; reaction.detail for complications; supportingInfo for documents","Pending","openspec/specs/immunizations/spec.md; IMMUNIZATIONS_SCREENS_SPECS.md; FHIR_HARMONIZATION_MAP.md#1.4"
"Supplements","supplements; supplement_documents","name, dosage, frequency, status, start_date_raw, brand","MedicationStatement (category=\"dietary-supplement\")","category coding differentiates supplements; derivedFrom for docs","Pending","openspec/specs/supplements/spec.md; SUPPLEMENTS_SCREENS_SPECS.md; FHIR_HARMONIZATION_MAP.md#1.6"
"My Documents","documents; document_folders; document_associations","name, folder_id, system, tags[], is_private, is_highlighted, file_url","DocumentReference","Folder + highlight flags via custom extensions; securityLabel for privacy; category for body system","Pending","openspec/specs/my-documents/spec.md; MY_DOCUMENTS_SCREENS_SPECS.md; FHIR_HARMONIZATION_MAP.md#2.1"
"Personal Information","user_profiles; patient_demographics; emergency_contacts; patient_insurance","legal_first_name, gender_identity, preferred_language, height_weight, contacts, insurance fields","Patient; RelatedPerson; Coverage","Emergency contacts → Patient.contact; insurance → Coverage; donor status via extension","Pending","openspec/specs/personal-information/spec.md; PERSONAL_INFORMATION_SCREENS_SPECS.md; FHIR_HARMONIZATION_MAP.md#3.1"
"Social History","social_history; social_history_documents","smoking_status, alcohol_use, drug_use, living_situation, occupation, caffeine_use","Observation (LOINC-coded)","Each field maps to Observation.code with LOINC; document links via supportingInfo","Pending","openspec/specs/social-history/spec.md; SOCIAL_HISTORY_SCREENS_SPECS.md; FHIR_HARMONIZATION_MAP.md#3.2"
"Family History","family_history; family_history_conditions; family_history_documents","relationship, relative_name, conditions[], age_at_diagnosis, notes","FamilyMemberHistory","Multiple conditions via relatedCondition extension; document links via supportingInfo","Pending","openspec/specs/family-history/spec.md; FAMILY_HISTORY_SCREENS_SPECS.md; FHIR_HARMONIZATION_MAP.md#3.3"
"Access Grants","access_grants; access_grant_scopes","grantee_email, expires_at, passcode, can_share_documents","Consent","Scopes map to Consent.provision.actor/action; passcode stored as Consent.verification","Pending","openspec/specs/my-documents/spec.md#share; FHIR_HARMONIZATION_MAP.md#4.1"
"Audit Logs","audit_logs","actor_id, event_type, object_type, metadata_json","AuditEvent","Maps directly to AuditEvent.agent/entity; retains HIPAA trail","Pending","SYSTEM_LOGIC_FRAMEWORK.md; FHIR_HARMONIZATION_MAP.md#4.2"
"Notifications","notifications; notification_preferences","title, body, delivery_channel, read_at, preference toggles","(No direct FHIR export)","Internal-only; optional mapping to Communication if needed","Pending","DISPLAY_RULES_PATIENT_VS_PROVIDER.md; FHIR_HARMONIZATION_MAP.md#4.3"
"Dual-Mode Date Framework","Database functions: compute_date_from_age; extract_computed_date; generate_patient_display; generate_provider_display; table columns *_raw/*_display_pt/*_display_pr","Functions stored in scripts/dual-mode-date-functions.sql; triggers update UPDATED_AT + display columns","Used wherever dates exported (MedicationStatement.effectivePeriod, Condition.onset, Procedure.performed, etc.)","Patient display text for UI; provider display for clinical export; ensures consistent derived dates","Pending (future validation rules)","DUAL_MODE_DATE_INPUT_COMPONENT.md; scripts/dual-mode-date-functions.sql; DATE_TIME_SELECTION_FRAMEWORK.md"
